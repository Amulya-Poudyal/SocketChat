<!DOCTYPE html>
<html>
<head>
    <title>Login - Chat App</title>
    <style>
        body { 
            font-family: Arial; 
            background: #121212; 
            color: #eee; 
            display:flex; 
            justify-content:center; 
            align-items:center; 
            height:100vh; 
        }
        .container { 
            background:#1e1e1e; 
            padding:30px; 
            border-radius:8px; 
            box-shadow:0 0 20px rgba(0,0,0,0.5); 
        }
        input { 
            display:block; 
            margin:10px 0; 
            padding:8px; 
            width:250px; 
            border-radius:5px; 
            border:none; 
            background:#2c2c2c; 
            color:#eee; 
        }
        input::placeholder { color:#aaa; }
        button { 
            padding:8px 20px; 
            cursor:pointer; 
            background:#bb86fc; 
            color:#121212; 
            border:none; 
            border-radius:5px; 
            transition:0.2s; 
        }
        button:hover { background:#985eff; }
        .link { 
            margin-top:10px; 
            display:block; 
            color:#bb86fc; 
            cursor:pointer; 
            text-decoration:underline; 
        }
        .link:hover { color:#985eff; }
        .error { color:#ff6b6b; margin-top:5px; }
    </style>
</head>
<body>
    <div class="container">
        <h2>Login</h2>
        <input id="username" placeholder="Username">
        <input id="password" placeholder="Password" type="password">
        <button onclick="loginUser()">Login</button>
        <span class="link" onclick="location.href='register.html'">Don't have an account? Register</span>
        <div id="error" class="error"></div>
    </div>

<script>
function loginUser() {
    const username = document.getElementById('username').value;
    const password = document.getElementById('password').value;
    const errorDiv = document.getElementById('error');
    errorDiv.textContent = '';

    if (!username || !password) {
        errorDiv.textContent = "Both fields are required";
        return;
    }

    fetch("http://192.168.31.198:3000/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ username, password })
    })
    .then(async res => {
        const data = await res.json();
        if (!res.ok) throw new Error(data || "Login failed");
        return data;
    })
    .then(data => {
        localStorage.setItem("username", data.username);
        location.href = "chat.html";
    })
    .catch(err => errorDiv.textContent = err.message);
}
</script>
</body>
</html>
